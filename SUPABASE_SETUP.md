# Supabase λ°±μ—”λ“ μ„¤μ • κ°€μ΄λ“

Newton μ•±μ Supabase λ°±μ—”λ“ μ„¤μ •μ„ μ„ν• λ‹¨κ³„λ³„ κ°€μ΄λ“μ…λ‹λ‹¤.

## π€ 1λ‹¨κ³„: Supabase ν”„λ΅μ νΈ μƒμ„±

1. [Supabase](https://supabase.com)μ— μ ‘μ†ν•μ—¬ κ³„μ • μƒμ„±/λ΅κ·ΈμΈ
2. "New project" ν΄λ¦­
3. ν”„λ΅μ νΈ μ΄λ¦„: `newton-app`
4. λ°μ΄ν„°λ² μ΄μ¤ λΉ„λ°€λ²νΈ μ„¤μ • (μ•μ „ν• λΉ„λ°€λ²νΈ μƒμ„±)
5. λ¦¬μ „ μ„ νƒ: `Southeast Asia (Singapore)` λλ” κ°€μ¥ κ°€κΉμ΄ λ¦¬μ „
6. "Create new project" ν΄λ¦­

## π”‘ 2λ‹¨κ³„: ν™κ²½λ³€μ μ„¤μ •

1. Supabase λ€μ‹λ³΄λ“μ—μ„ **Settings > API** λ΅ μ΄λ™
2. **Project URL**κ³Ό **anon public** ν‚¤ λ³µμ‚¬
3. ν”„λ΅μ νΈ λ£¨νΈμ— `.env` νμΌ μƒμ„±:

```env
EXPO_PUBLIC_SUPABASE_URL=your-supabase-project-url
EXPO_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key
```

β οΈ **μ¤‘μ”**: `.env` νμΌμ„ `.gitignore`μ— μ¶”κ°€ν•μ—¬ Gitμ— μ»¤λ°‹λμ§€ μ•λ„λ΅ ν•μ„Έμ”.

## π—„οΈ 3λ‹¨κ³„: λ°μ΄ν„°λ² μ΄μ¤ μ¤ν‚¤λ§ μ„¤μ •

1. Supabase λ€μ‹λ³΄λ“μ—μ„ **SQL Editor** λ©”λ‰΄λ΅ μ΄λ™
2. "New query" ν΄λ¦­
3. `supabase/schema.sql` νμΌμ λ‚΄μ©μ„ λ³µμ‚¬ν•μ—¬ λ¶™μ—¬λ„£κΈ°
4. "Run" λ²„νΌ ν΄λ¦­ν•μ—¬ μ¤ν‚¤λ§ μƒμ„±

### μƒμ„±λλ” ν…μ΄λΈ”:
- **profiles**: μ‚¬μ©μ ν”„λ΅ν•„ μ •λ³΄
- **notes**: λ…ΈνΈ λ°μ΄ν„° (μ λ©, λ‚΄μ©, κ³µκ°/λΉ„κ³µκ° μ„¤μ •)
- **stars**: λ…ΈνΈ λ³„ν‘/μΆ‹μ•„μ” κΈ°λ΅
- **forks**: λ…ΈνΈ ν¬ν¬ κΈ°λ΅

## π” 4λ‹¨κ³„: μΈμ¦ μ„¤μ •

1. Supabase λ€μ‹λ³΄λ“μ—μ„ **Authentication > Settings** λ΅ μ΄λ™
2. **Site URL** μ„¤μ •: κ°λ°μ©μΌλ΅ `http://localhost:19006` μ¶”κ°€
3. **Email Auth** ν™μ„±ν™” ν™•μΈ
4. ν•„μ”ν• κ²½μ° **μ†μ… λ΅κ·ΈμΈ** μ„¤μ • (Google, GitHub λ“±)

### μ΄λ©”μΌ ν…ν”λ¦Ώ μ»¤μ¤ν„°λ§μ΄μ§• (μ„ νƒμ‚¬ν•­):
- **Authentication > Email Templates**μ—μ„ κ°€μ… ν™•μΈ, λΉ„λ°€λ²νΈ μ¬μ„¤μ • λ“±μ μ΄λ©”μΌ ν…ν”λ¦Ώ μμ • κ°€λ¥

## π“ 5λ‹¨κ³„: μ¤ν† λ¦¬μ§€ μ„¤μ • (μ•„λ°”νƒ€ μ΄λ―Έμ§€μ©)

1. **Storage** λ©”λ‰΄λ΅ μ΄λ™
2. "Create a new bucket" ν΄λ¦­
3. Name: `avatars`
4. Public bucketμΌλ΅ μ„¤μ •
5. "Create bucket" ν΄λ¦­

### μ¤ν† λ¦¬μ§€ μ •μ±… μ„¤μ •:
```sql
-- μ•„λ°”νƒ€ μ—…λ΅λ“ μ •μ±…
CREATE POLICY "Avatar images are publicly accessible."
ON storage.objects FOR SELECT
USING (bucket_id = 'avatars');

CREATE POLICY "Users can upload their own avatar."
ON storage.objects FOR INSERT
WITH CHECK (bucket_id = 'avatars' AND auth.uid()::text = (storage.foldername(name))[1]);
```

## π”„ 6λ‹¨κ³„: μ‹¤μ‹κ°„ κΈ°λ¥ μ„¤μ •

1. **Database > Replication** λ©”λ‰΄λ΅ μ΄λ™
2. `notes`, `stars`, `forks` ν…μ΄λΈ”μ Realtimeμ„ ν™μ„±ν™”
3. μ΄λ¥Ό ν†µν•΄ μ‹¤μ‹κ°„ μ—…λ°μ΄νΈκ°€ μ•±μ— λ°μλ©λ‹λ‹¤.

## π§ 7λ‹¨κ³„: ν…μ¤νΈ λ°μ΄ν„° μƒμ„± (μ„ νƒμ‚¬ν•­)

```sql
-- ν…μ¤νΈμ© κ³µκ° λ…ΈνΈ μƒμ„± (μ‹¤μ  μ‚¬μ©μ μƒμ„± ν›„ μ‹¤ν–‰)
INSERT INTO public.notes (user_id, title, content, is_public) VALUES
(
  (SELECT id FROM public.profiles LIMIT 1),
  'Newton μ•±μ— μ¤μ‹  κ²ƒμ„ ν™μν•©λ‹λ‹¤!',
  '# NewtonμΌλ΅ μ‹μ‘ν•λ” μƒλ΅μ΄ λ…ΈνΈ κ²½ν—

Newtonμ€ κ°μΈ λ…ΈνΈμ™€ κ³µκ° λ…ΈνΈλ¥Ό ν†µν•΄ μ§€μ‹μ„ κ³µμ ν•κ³  μκ°μ„ μ–»μ„ μ μλ” ν”λ«νΌμ…λ‹λ‹¤.

## μ£Όμ” κΈ°λ¥
- π“ **κ°μΈ λ…ΈνΈ**: λ‚λ§μ μƒκ°μ„ μ •λ¦¬
- π **κ³µκ° λ…ΈνΈ**: λ‹¤λ¥Έ μ‚¬λλ“¤κ³Ό μ§€μ‹ κ³µμ 
- β­ **λ³„ν‘**: μΆ‹μ€ λ…ΈνΈμ— λ³„ν‘ ν‘μ‹
- π΄ **ν¬ν¬**: λ‹¤λ¥Έ μ‚¬λμ λ…ΈνΈλ¥Ό λ³µμ‚¬ν•μ—¬ λ‚΄ κ²ƒμΌλ΅ μμ •

μ§€κΈ λ°”λ΅ μ²« λ²μ§Έ λ…ΈνΈλ¥Ό μ‘μ„±ν•΄λ³΄μ„Έμ”!',
  true
);
```

## π€ 8λ‹¨κ³„: μ•± μ‹¤ν–‰

1. ν„°λ―Έλ„μ—μ„ ν”„λ΅μ νΈ λ””λ ‰ν† λ¦¬λ΅ μ΄λ™
2. ν™κ²½λ³€μκ°€ μ¬λ°”λ¥΄κ² μ„¤μ •λμ—λ”μ§€ ν™•μΈ
3. μ•± μ‹¤ν–‰:
```bash
npm start
# λλ”
npx expo start
```

## π“ λ¨λ‹ν„°λ§

Supabase λ€μ‹λ³΄λ“μ—μ„ λ‹¤μ μ •λ³΄λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤:
- **Auth**: κ°€μ…λ μ‚¬μ©μ μ λ° ν™λ™
- **Database**: ν…μ΄λΈ” λ°μ΄ν„° λ° μΏΌλ¦¬ μ„±λ¥
- **API**: API μ‚¬μ©λ‰ λ° μ‘λ‹µ μ‹κ°„
- **Storage**: μ—…λ΅λ“λ νμΌ ν„ν™©

## π”§ λ¬Έμ  ν•΄κ²°

### μμ£Ό λ°μƒν•λ” λ¬Έμ :

1. **μ—°κ²° μ¤λ¥**
   - `.env` νμΌμ URLκ³Ό ν‚¤κ°€ μ •ν™•ν•μ§€ ν™•μΈ
   - λ„¤νΈμ›ν¬ μ—°κ²° μƒνƒ ν™•μΈ

2. **μΈμ¦ μ¤λ¥**
   - RLS μ •μ±…μ΄ μ¬λ°”λ¥΄κ² μ„¤μ •λμ—λ”μ§€ ν™•μΈ
   - μ‚¬μ©μκ°€ μ¬λ°”λ¥Έ κ¶ν•μ„ κ°–κ³  μλ”μ§€ ν™•μΈ

3. **μ‹¤μ‹κ°„ μ—…λ°μ΄νΈ μ•λ¨**
   - Realtimeμ΄ ν•΄λ‹Ή ν…μ΄λΈ”μ— ν™μ„±ν™”λμ–΄ μλ”μ§€ ν™•μΈ
   - ν΄λΌμ΄μ–ΈνΈμ—μ„ κµ¬λ…μ΄ μ¬λ°”λ¥΄κ² μ„¤μ •λμ—λ”μ§€ ν™•μΈ

## π›΅οΈ λ³΄μ• κ³ λ ¤μ‚¬ν•­

- ν”„λ΅λ•μ… ν™κ²½μ—μ„λ” RLS μ •μ±…μ„ λ”μ± μ—„κ²©ν•κ² μ„¤μ •
- API ν‚¤λ¥Ό μ•μ „ν•κ² κ΄€λ¦¬ (ν™κ²½λ³€μ μ‚¬μ©)
- μ •κΈ°μ μΈ λ°μ΄ν„°λ² μ΄μ¤ λ°±μ—… μ„¤μ •
- Rate limiting μ„¤μ •μΌλ΅ API λ‚¨μ© λ°©μ§€

---

μ΄ κ°€μ΄λ“λ¥Ό λ”°λΌ μ„¤μ •ν•λ©΄ Newton μ•±μ μ™„μ „ν• λ°±μ—”λ“ κΈ°λ¥μ„ μ‚¬μ©ν•  μ μμµλ‹λ‹¤. λ¬Έμ κ°€ λ°μƒν•λ©΄ Supabase λ¬Έμ„λ‚ μ»¤λ®¤λ‹ν‹°λ¥Ό μ°Έμ΅°ν•μ„Έμ”.